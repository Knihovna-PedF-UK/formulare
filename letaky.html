<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cedule</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: auto;
      padding: 20px;
    }
    textarea {
      width: 100%;
      height: 150px;
      margin-bottom: 20px;
      font-size: 1rem;
      padding: 10px;
    }
    #tabulka {
      border: 1px solid #ccc;
      padding: 10px;
      font-family: monospace;
      background-color: #f9f9f9;
      white-space: pre;
      display: none;
    }
    pre {
      border: 1px solid #ccc;
      padding: 10px;
      font-family: monospace,monospace;
      background-color: #f9f9f9;
      margin-bottom: 1rem;
    }
    code{font-family: monospace,monospace;background-color: #f9f9f9;border: 1px solid #ccc;}
    article {
      margin-top: 1rem;
    }
  </style>
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/tiny-brutalism.css">
  <script>
    //trik, abych mohl v importovaný knihovně použít moduly
    module = {};
  </script>
  <script src="js/texlive-compile.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/3.41.0/minified.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="js/markdown.js" type="text/javascript"></script>
</head>
<body>

  <header id="header">
    <menu>
  <a href="./index.html">Domů</a> | 
  <a href="./signatury.html">Signatury</a> | 
  <a href="./signatura2.html">Signatury 2</a> | 
  <a href="./carovekody.html">Čárové kódy</a> |
  <a href="./letaky.html">Cedule</a>
</menu>

  </header>
  <template id="sova_black_pdf">
    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sMMOlDgeHbseQfTHzyvRUUUq7EgpbX8n5VMbn/5WfJhfzjsaSVbz7EQ6oG0GoTIjtdfooVGNV66O91YYTqbJ1uwrKpbmHrsoPb4k0ONa+zvoBxL/FyX/PP5+/A964ljJCmVuZHN0cmVhbQplbmRvYmoKNSAwIG9iagogICAzNjIyCmVuZG9iagozIDAgb2JqCjw8CiAgIC9FeHRHU3RhdGUgPDwKICAgICAgL2EwIDw8IC9DQSAxIC9jYSAxID4+CiAgID4+Cj4+CmVuZG9iagoyIDAgb2JqCjw8IC9UeXBlIC9QYWdlICUgMQogICAvUGFyZW50IDEgMCBSCiAgIC9NZWRpYUJveCBbIDAgMCAyNzYuNTIwMjk0IDI3Ni41MjE1NDUgXQogICAvQ29udGVudHMgNCAwIFIKICAgL0dyb3VwIDw8CiAgICAgIC9UeXBlIC9Hcm91cAogICAgICAvUyAvVHJhbnNwYXJlbmN5CiAgICAgIC9JIHRydWUKICAgICAgL0NTIC9EZXZpY2VSR0IKICAgPj4KICAgL1Jlc291cmNlcyAzIDAgUgo+PgplbmRvYmoKMSAwIG9iago8PCAvVHlwZSAvUGFnZXMKICAgL0tpZHMgWyAyIDAgUiBdCiAgIC9Db3VudCAxCj4+CmVuZG9iago2IDAgb2JqCjw8IC9Qcm9kdWNlciAoY2Fpcm8gMS4xNi4wIChodHRwczovL2NhaXJvZ3JhcGhpY3Mub3JnKSkKICAgL0NyZWF0b3IgPEZFRkYwMDQ5MDA2RTAwNkIwMDczMDA2MzAwNjEwMDcwMDA2NTAwMjAwMDMxMDAyRTAwMzAwMDIwMDAyODAwNjgwMDc0MDA3NDAwNzAwMDczMDAzQTAwMkYwMDJGMDA2OTAwNkUwMDZCMDA3MzAwNjMwMDYxMDA3MDAwNjUwMDJFMDA2RjAwNzIwMDY3MDAyOT4KICAgL0NyZWF0aW9uRGF0ZSAoRDoyMDIwMDYxNzEyMTUxNSswMicwMCkKPj4KZW5kb2JqCjcgMCBvYmoKPDwgL1R5cGUgL0NhdGFsb2cKICAgL1BhZ2VzIDEgMCBSCj4+CmVuZG9iagp4cmVmCjAgOAowMDAwMDAwMDAwIDY1NTM1IGYgCjAwMDAwMDQwNDEgMDAwMDAgbiAKMDAwMDAwMzgwOSAwMDAwMCBuIAowMDAwMDAzNzM3IDAwMDAwIG4gCjAwMDAwMDAwMTUgMDAwMDAgbiAKMDAwMDAwMzcxNCAwMDAwMCBuIAowMDAwMDA0MTA2IDAwMDAwIG4gCjAwMDAwMDQzODEgMDAwMDAgbiAKdHJhaWxlcgo8PCAvU2l6ZSA4CiAgIC9Sb290IDcgMCBSCiAgIC9JbmZvIDYgMCBSCj4+CnN0YXJ0eHJlZgo0NDMzCiUlRU9GCg==
  </template>
  <template id="letaky_tex">
    \documentclass{article}
\usepackage{fontspec}
\usepackage{pedfstyles}
\usepackage{titlesec}
\setmainfont{TeX Gyre Heros}
\usepackage{uklogo}
\usepackage[margin=2.5cm,left=2.5cm]{geometry}
\usepackage{ragged2e}


\usepackage[czech]{babel}
\usepackage{luavlna}
\usepackage{fontawesome}
\usepackage{eso-pic}
\usepackage[characters=66,lineheight=1.2,scale=golden]{responsive}

% umístění loga do pravého horního rohu
% \AddToShipoutPictureBG{
% \AtTextUpperLeft{%
% \vtop{
% \null\hfill\logosova[32pt]
% }
% }}


\begin{document}

\pagestyle{empty}

\raggedright

\parindent=0pt
\parskip=1em


{{qrcode}}

{{logo-bottom}}

{{content}}

\end{document}

  </template>
  <template id="uklogo_sty">
    \ProvidesPackage{uklogo}
\RequirePackage{graphicx}
\RequirePackage{xcolor}
\RequirePackage{qrcode}
\RequirePackage{url}

% definice fontů
%\RequirePackage{LibreBodoni}
\AtBeginDocument{%
\@ifpackageloaded{fontspec}{%
  \newfontfamily\librebodoni
      [ UprightFont    = *-Regular ,
        ItalicFont     = *-Italic ,
        BoldFont       = *-Bold , 
        BoldItalicFont = *-BoldItalic ]
      {LibreBodoni}
}{
  \newcommand*\librebodoni{\fontfamily{\librebodonifamily}\selectfont}
}}


\newcommand\uklogofont{\sffamily}
%\usepackage{gridset}
%\usepackage{blindtext}
% \raggedbottom

% \pagestyle{myheadings}

%\markright{gridbase=\gridbase, gridinterval=\gridinterval\ without move down}%
\def\uklogo@library{Knihovna}
\def\uklogo@faculty{PedF UK}
\def\uklogo@box#1#2{\baselineskip=#1\ukselect#1\hbox{#2}}
\def\uklogo@file{logo-6.mps}
\newcommand\logooriginal[1][32pt]{%
  \begingroup % changes should be local
  \uklogofont
  \def\uksmallfont{\the\dimexpr #1/3\relax}%
  \def\ukbigfont{\the\dimexpr #1/3*2\relax}%
  \def\ukselect##1{\fontsize{##1}{##1}\selectfont}
  \def\uklogoskip{\the\dimexpr #1/10\relax}%
  %%%%%%%%%%%
  \def\logodim{\the\dimexpr#1/10*11\relax}%
  \hbox{%
    \vbox{%
      \hbox{\raisebox{\the\dimexpr #1/20*21\relax}{\rotatebox{270}{\includegraphics[height=\logodim,width=\logodim]{\uklogo@file}}}}
      % \hbox{\raisebox{\the\dimexpr #1/20*21\relax}{{\includegraphics[height=\logodim,width=\logodim]{logo-6.mps}}}}
      % \hbox{\includegraphics[height=\logodim,width=\logodim]{logo-5.mps}}
    }%
    \hskip\uklogoskip%
    \vbox{%
      % už nejsme ústřední
      % \uklogo@box\uksmallfont{Ústřední}%\\% 
      % zarovnání s ostatními řádky
      \uklogo@box\ukbigfont{\kern-\the\dimexpr\ukbigfont/100*5\relax\uklogo@library}%\\%
      % oprava vertikálního zarovnání
      \kern\the\dimexpr #1/10\relax%
      \uklogo@box\uksmallfont{\uklogo@faculty}%
    }%
  }%
  \endgroup
}


% nové logo podle vizuální identity PedF UK z roku 2020
\def\sova@imgfile{sova-black.pdf}
\def\sova@faculty{PEDAGOGICKÁ FAKULTA}
\def\sova@university{Univerzita Karlova}
\def\sova@library{Knihovna}
\def\sova@unicolor{black}% 
\def\sova@letterspace{10.0}
\newcommand\logosova[1][32pt]{%
  \bgroup%
  \def\sova@linesize{\the\dimexpr #1/5\relax}% Calculate font size based on the desired logo height
  \def\sova@fontsize{\the\dimexpr #1/50*9\relax}% font size = img height / 5 * 0.8 
  \fontsize{\sova@linesize}{\sova@linesize}\selectfont% 
  \librebodoni%
  % remove table padding
  \setlength{\tabcolsep}{0pt}
  \tabular{@{}lp{\sova@fontsize}l@{}}%
  \parbox{#1}{%
    \textcolor{\sova@unicolor}{%
      \includegraphics[height=#1,keepaspectratio]{\sova@imgfile}%
    }%
  }%
  & ~ &% the second cell inserts horizontal space
  % \bfseries%
  \setbox0=\hbox{\addfontfeature{LetterSpace=\sova@letterspace}\sova@faculty}% measure longest text
  \parbox{\wd0}{% 
    \addfontfeature{LetterSpace=\sova@letterspace}\sova@faculty\\%
    \addfontfeature{LetterSpace=\sova@letterspace}\sova@library\\%
    \addfontfeature{LetterSpace=\sova@letterspace}\color{\sova@unicolor}%
    \sova@university%
  }\\%
  \endtabular%
  \egroup%
}

% logo in shades of red
\newcommand\logosovacolor[1][32pt]{%
  \bgroup%
  \definecolor{ca3344}{HTML}{ca3344}%
  \def\sova@unicolor{ca3344}%
  \def\sova@imgfile{sova-oficial-color.pdf}%
  \logosova[#1]%
  \egroup%
}

% outline logo with red border
\newcommand\logosovacoloroutline[1][32pt]{%
  \bgroup%
  \definecolor{ca3344}{HTML}{ca3344}%
  \def\sova@unicolor{ca3344}%
  \def\sova@imgfile{sova-red.pdf}%
  \logosova[#1]%
  \egroup%
}


% set default logo to sova
\let\uklogo\logosova

% put info into qrcode
% to add html ID (like foo.cz/xx#aaa)
% use \qrbox[id]{text}{url}
% don't use protocol in URL
% correct use:
% \qrbox[tymovka]{Hello world}{knihovna.pedf.cuni.cz/studovna.html}
% \qrbox{Hello}{knihovna.pedf.cuni.cz/studovna.html} -- without link to ID destination in the page
% this command adds ?qr-\jobname to the qr code - this enables us access to the web from the qr code
% ideally, use URL shortener: \qrbox{Hello}{bit.ly/3fJL1Ye}
% you must add ?qr-<identifier> part to the url that is resolved by the shortener
 
\newcommand\qrbox[3][]{%
  \bgroup
  \small%
  \vbox{#2\\[\baselineskip]{\footnotesize #3}\texttt{\ifx\relax#1\relax\else\##1\fi}\\\qrcode[height=2cm]{https://#3?qr-\jobname\ifx\relax#1\relax\else\##1\fi}}
  \egroup
}

\ExplSyntaxOn

\tl_new:N \qr_platba_tl
\dim_new:N \qr_platba_height
\dim_set:Nn \qr_platba_height{2cm}

\keys_define:nn {qr_platba}{
  msg .code:n    = \tl_put_right:Nn \qr_platba_tl{*MSG:#1},
  price .code:n  = \tl_put_right:Nn \qr_platba_tl{*AM:#1},
  currency .code:n  = \tl_put_right:Nn \qr_platba_tl{*CC:#1},
  identifier .code:n = \tl_put_right:Nn \qr_platba_tl{*RF:#1},
  name .code:n = \tl_put_right:Nn \qr_platba_tl{*RN:#1},
  email .code:n = \tl_put_right:Nn \qr_platba_tl{*NT:E*NTA:#1},
  phone .code:n = \tl_put_right:Nn \qr_platba_tl{*NT:P*NTA:#1},
  height .dim_set:N = \qr_platba_height
}

% format details: https://en.wikipedia.org/wiki/Short_Payment_Descriptor
% #1 key-val options
% #2 IBAN account number - required
\newcommand\qrpayment[2][]{%
  \tl_set:Nn\qr_platba_tl{SPD*1.0*ACC:#2}%
  \keys_set:nn {qr_platba}{#1}%
  \qrcode[height=\qr_platba_height]{\tl_use:N\qr_platba_tl}%
}
\ExplSyntaxOff

\endinput

  </template>
  <template id="pedfstyles_sty">
    \ProvidesPackage{pedfstyles}
\RequirePackage{uklogo}
\RequirePackage{xcolor}
\RequirePackage{kvoptions}
\RequirePackage{array}
\RequirePackage{titlesec}
%\RequirePackage{geometry}

\definecolor{pedfcolor}{HTML}{ca3345}

\DeclareStringOption[11]{month}
\ProcessKeyvalOptions*

\let\akcesize\large
\newcommand\bigtitle[1]{\bgroup\raggedright\fontsize{46}{48}\selectfont\bfseries\strut #1\strut\egroup\par\hugeskip}
\newcommand\smalltitle[1]{\bgroup\akcesize\raggedright\bfseries#1\egroup\par\medskip}
\newcommand\hugeskip{\vskip5\baselineskip}
\newenvironment{akce}
{%
  \setlength\tabcolsep{0pt}%
  \akcesize%
  \tabular{@{} >{\addfontfeature{Numbers={Tabular}}} p{7.3em} >{\addfontfeature{Numbers={Tabular}}} p{3.5em} >{\raggedright\arraybackslash} p{24em} @{}}%
}
{\endtabular\par\bigskip}
% \def\current@month{11}
\newcommand\datum[1]{#1.\,\pedfstyles@month.}
% jen pro datumy během jednoho měsíce
\newcommand\rozsah[2]{\datum{#1}\,--\,\datum{#2}}

% https://tex.stackexchange.com/a/703753/2891
\providecommand{\balancebox}[2]% #1 = max width, #2 = contents
{\begingroup% save registers
  \dimendef\height=0%
  \dimendef\width=1%
  \dimendef\test=2%
  \settowidth{\test}{#2}% single line check
  \width=#1\relax
  \ifdim\test>\width
    \settoheight{\height}{\parbox{#1}{\raggedright #2}}%
    \loop
      \advance\width by -1em
      \settoheight{\test}{\parbox{\width}{\raggedright #2}}%
      \ifdim\test=\height\repeat
    \advance\width by 1em
  \fi
  \parbox{\width}{\strut\BalancedRagged #2\strut}%
\endgroup}

% https://tex.stackexchange.com/a/705079/2891
\protected\def\BalancedRagged{%
\leftskip     0pt%
\rightskip    0pt plus 10em%
\spaceskip=1\fontdimen2\font plus .5\fontdimen3\font minus 1.5\fontdimen4\font%%
\xspaceskip=1\fontdimen2\font plus 1\fontdimen3\font minus 1\fontdimen4\font%
\parfillskip  0pt plus 15em%
\relax%
}%

\titleformat{\section}[block]
{}{}{0pt}{\normalfont\huge\bfseries\balancebox{\textwidth}}[\vskip\baselineskip]

\titleformat{\subsection}[block]
  {}{}{0pt}{\normalfont\bfseries\BalancedRagged}

\titleformat{\subsubsection}[block]
  {}{}{0pt}{\normalfont\bfseries\BalancedRagged}



\endinput

  </template>
  <template id="logo-bottom">
\setbox1=\vtop{\logosova[48pt]}
\ExplSyntaxOn
\AddToHook{shipout/background}{\put(2cm,\dim_eval:n{-28.7cm + 2\ht1+2\dp1}){\parbox[b][][b]{\the\wd1}{\box1}}}
\ExplSyntaxOff
  </template>
  <template id="qrcode">
\setbox0=\hbox{\parbox[b][][b]{7em}{\raggedright\qrbox{{{text}}}{{{url}}}}}
\ExplSyntaxOn
\AddToHook{shipout/background}
{\put(\dim_eval:n{20cm-\wd0},\dim_eval:n{-28.7cm + \ht0+\dp0-\baselineskip}){\box0}}
\ExplSyntaxOff
  </template>
  <h1>Cedule</h1>
  <textarea id="pole" rows="10" cols="50" placeholder="Zadejte data"></textarea>
<details><summary>Nastavení</summary>
  <!-- <legend>Startovací řádek: <input id="row" value="1" /></legend> -->
  <!-- <legend>Startovací sloupec: <input id="column" value="1" /></legend> -->
  <label>Zobrazit logo: <select id="position-select" name="position">
    <option value="bottom">Dole</option>
    <!-- <option value="top" >Nahoře</option> -->
    <option value="hidden">Nezobrazovat</option>
  </select>
   </label>
  <label for="qr-text">Popisek QR kódu</label>
  <input type="text" id="qr-text" list="suggestions" />
  <datalist id="suggestions">
    <option value="Další informace o provozní době naleznete zde:"></option>
    <option value="Detailní otevírací doba / Full Opening Hours:"></option>
  </datalist>
  <label for="qr-link">Odkaz do QR kódu</label>
  <input type="text" id="qr-link" list="qr-suggestions" />
  <datalist id="qr-suggestions">
    <option value="bit.ly/3qN7E4g">Provozní doba</option>
  </datalist>


</details>
<button id="nacti">Načíst data</button>
<button id="generovat">Generovat PDF</button>
<div id="tabulka"></div>

  <article>
  <p>Tvorba cedulí pro knihovnu. Můžete použít <a href="https://jecas.cz/markdown">Markdown</a>. Příklad:</p>
<pre>
# Nadpis

Text oznámení. *Text v kurzívě* a **text tučně**. 

Tři spojovníky vloží mezeru na dva řádky:

---

## Otevírací doba

Po–čt | 8.00 – 18.00
------|-------------
Pá    | 8:00 – 17.00
</pre>

<p>Pro zalomení řádku použijte dvě zpětná lomítka (<code>\\</code>). Nezalomitelná mezera se vkládá pomocí tildy (<code>~</code>).</p>

<h2>Nastavení</h2>
<p>
V nastavení můžete zvolit, jestli zobrazovat logo. Také můžete přidat odkaz jako QR kód. Popisek a odkaz můžete vybrat z předpřipravených hodnot. Oboje se snažte udržovat co nejkratší.
</p>
  </article>

  <!-- <textarea id="markdownInput" placeholder="Zadejte Markdown..."></textarea> -->

  <script>
function findFirstUniqueChar(str1, str2) {
  for (let char of str1) {
    if (!str2.includes(char)) {
      return char;
    }
  }
  return null;
}

function columnalign(token){
  // get LaTeX table align from markdown table align
  let aligns = {left: "l", right : "r", center: "c" }
  return token.align ? aligns[token.align] : "l";
}

const pole = document.getElementById('pole');
const generovat = document.getElementById("generovat")
const tabulka = document.getElementById('tabulka');
const uklogo_sty = document.getElementById("uklogo_sty");
const letaky_tex = document.getElementById("letaky_tex");
const pedfstyles_sty = document.getElementById("pedfstyles_sty");
const sova_black_pdf = document.getElementById("sova_black_pdf");
const position = document.getElementById("position-select");
const logo_bottom = document.getElementById("logo-bottom");
const qr_text = document.getElementById("qr-text");
const qr_link = document.getElementById("qr-link");
const qr_code_tpl = document.getElementById("qrcode");

let latex = "";
    // Funkce aktualizující výstup při změně textu
nacti.addEventListener('click', () => {
  const markdown = pole.value;
  latex = marked.parse(markdown );
  tabulka.textContent = latex;
  tabulka.style.display = "block";
  generovat.style.visibility = "visible";
});
generovat.addEventListener('click', () => {
  const texlive = new TeXLiveForm();
  // Načtení hodnot z inputů
  const template = letaky_tex.content.textContent
  let latexCode = template.replace('{{content}}', latex);
  let logo_bottom_value = ""
  let qr_code = "";
  if(position.value == "bottom"){
    logo_bottom_value = logo_bottom.content.textContent
  } 

  if(qr_link.value && qr_link.value != "") {
    // console.log("qr_text: " + qr_text.value);
    // console.log("qr_link: " + qr_link.value);
    qr_code = qr_code_tpl.content.textContent;
    qr_code = qr_code.replace("{{text}}", qr_text.value);
    qr_code = qr_code.replace("{{url}}", qr_link.value);
  }

  latexCode = latexCode.replace("{{logo-bottom}}", logo_bottom_value)
  latexCode = latexCode.replace("{{qrcode}}", qr_code);
  console.log(latexCode)
  // podpora pro binární soubor
  // Příklad použití
  texlive.submit([
    {
      name: 'document.tex',
      content: latexCode
    },{
      name: "uklogo.sty",
      content: uklogo_sty.content.textContent
    },{
      name: "pedfstyles.sty",
      content: pedfstyles_sty.content.textContent
    },{
      name: "sova-black.pdf",
      type:  "application/pdf",
      data: sova_black_pdf.content.textContent
    }
  ], {
    engine: 'lualatex',
    return: 'pdf'
  });

});
  </script>

</body>
</html>
